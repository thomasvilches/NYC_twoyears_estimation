
function days_vac_f(l::Int64)

    v = [i for i in p.day_inital_vac:(p.day_inital_vac+(l-2))]
    
    return v
end

function vaccination_rate_1(sim::Int64)
    
    if p.prov == :newyorkcity
        p.day_inital_vac = 105

        v = [0 0 0 0 0 0 0 0
                0 0 0 0 1 0 0 0
                0 0 0 0 12 5 1 0
                0 0 0 1 25 12 2 0
                0 0 0 1 31 12 2 0
                0 0 0 1 36 15 3 0
                0 0 0 0 12 4 0 0
                0 0 0 0 7 3 0 0
                0 0 0 1 29 20 6 8
                0 0 0 2 46 30 8 8
                0 0 0 3 61 42 12 14
                0 0 0 2 33 23 6 3
                0 0 0 0 1 1 1 0
                0 0 0 1 18 12 3 2
                0 0 0 2 15 9 2 2
                0 0 0 3 45 37 10 8
                0 0 0 3 43 39 11 10
                0 0 0 4 49 43 12 14
                0 0 0 3 31 24 7 7
                0 0 0 1 2 2 1 1
                0 0 0 2 18 10 3 1
                0 0 0 3 16 9 3 3
                0 0 0 5 49 44 12 12
                0 0 0 6 55 53 15 12
                0 0 0 9 68 64 18 17
                0 0 0 10 68 61 16 13
                0 0 0 9 70 57 16 13
                0 0 0 6 36 26 7 5
                0 0 0 6 36 26 7 6
                0 0 0 10 91 74 19 46
                0 0 0 10 91 78 29 63
                0 0 0 9 84 82 57 75
                0 0 0 10 84 81 76 87
                0 0 0 8 72 66 65 64
                0 0 0 8 65 60 83 69
                0 0 0 6 47 43 66 55
                0 0 0 6 53 59 77 67
                0 0 0 8 69 73 92 77
                0 0 0 8 69 70 98 90
                0 0 0 5 42 52 74 70
                0 0 0 5 43 49 71 66
                0 0 0 3 25 28 50 40
                0 0 0 2 12 14 17 17
                0 0 0 4 27 32 37 34
                0 0 0 3 27 37 51 43
                0 0 0 4 34 43 68 52
                0 0 0 8 56 64 101 76
                0 0 0 8 62 66 100 74
                0 0 0 4 28 39 70 46
                0 0 0 3 21 30 47 27
                0 0 0 1 4 6 6 3
                0 0 0 1 6 8 14 7
                0 0 0 3 25 32 65 39
                0 0 0 7 51 57 107 62
                0 0 0 7 56 60 108 62
                0 0 0 6 45 56 89 53
                0 0 0 4 29 32 42 21
                0 0 0 4 35 45 61 33
                0 0 0 5 35 43 65 34
                0 0 0 7 43 51 64 38
                0 0 0 11 73 74 88 51
                0 0 0 11 74 78 146 85
                0 0 0 8 53 60 100 59
                0 0 0 5 34 40 56 32
                0 0 0 5 36 45 28 18
                0 0 0 4 28 41 45 27
                0 0 0 4 32 47 47 28
                0 0 0 3 27 42 32 18
                0 0 0 5 29 43 33 20
                0 0 0 4 25 37 30 19
                0 0 0 2 14 22 13 9
                0 0 0 4 32 47 29 17
                0 0 0 7 62 96 56 34
                0 0 0 11 82 126 98 60
                0 0 0 22 150 205 122 75
                0 0 0 23 160 228 145 91
                0 0 0 22 133 195 112 69
                0 0 0 22 135 178 77 47
                0 0 0 14 94 139 104 59
                0 0 0 16 108 162 115 68
                0 0 0 19 117 175 112 66
                0 0 0 26 161 225 117 68
                0 0 0 28 157 231 117 68
                0 0 0 23 134 186 80 45
                0 0 0 19 111 143 49 29
                0 0 0 19 117 153 67 40
                0 0 0 18 111 156 82 48
                0 0 0 24 140 231 100 57
                0 0 0 29 173 301 91 54
                0 0 0 28 163 264 75 43
                0 0 0 24 130 203 53 30
                0 0 0 21 111 153 32 17
                0 0 0 20 110 168 43 26
                0 0 0 23 124 183 57 32
                0 0 0 27 138 196 61 34
                0 0 0 34 187 225 60 36
                0 0 0 34 179 217 57 33
                0 0 0 29 157 173 42 24
                0 0 0 23 129 130 26 13
                0 0 0 26 154 141 34 19
                0 0 0 27 155 182 41 25
                0 0 0 27 152 214 42 25
                0 0 0 30 162 230 39 22
                0 0 0 28 143 203 35 20
                0 0 0 27 135 193 34 17
                0 0 0 23 108 136 20 10
                0 0 0 27 132 189 29 16
                0 0 0 25 175 201 38 21
                0 0 0 26 245 222 39 23
                0 0 0 27 282 212 44 24
                0 0 0 24 247 182 36 19
                0 0 0 21 238 155 25 13
                0 0 0 18 169 95 18 8
                0 0 0 27 258 162 25 14
                0 0 0 72 319 187 30 16
                0 0 0 90 323 183 30 18
                0 0 0 109 322 190 36 20
                0 0 0 110 314 178 32 17
                0 0 0 108 267 151 26 14
                0 0 0 90 204 114 17 8
                0 0 0 101 248 140 23 12
                0 0 0 118 278 160 27 15
                0 0 0 118 248 160 31 17
                0 0 0 114 265 172 32 17
                0 0 0 117 257 170 32 16
                0 0 0 103 211 155 25 14
                0 0 0 72 139 98 14 7
                0 0 0 81 183 131 25 15
                0 0 0 84 195 143 29 18
                0 0 0 81 181 138 27 17
                0 0 0 76 177 140 29 19
                0 0 0 79 182 144 29 19
                0 0 0 68 154 120 20 10
                0 0 0 44 94 65 9 5
                0 0 0 50 132 101 21 13
                0 0 0 56 136 105 23 15
                0 0 0 51 130 99 22 14
                0 0 0 54 136 107 23 14
                0 0 0 60 145 112 23 14
                0 0 0 49 109 86 14 7
                0 0 0 28 62 42 7 3
                0 0 0 36 88 68 15 7
                0 0 0 44 110 83 20 11
                0 0 0 40 102 82 19 10
                0 0 0 40 98 77 19 11
                0 0 0 42 99 81 17 11
                0 0 0 38 82 61 11 5
                0 0 0 22 40 27 4 2
                0 0 0 29 67 56 13 7
                0 0 0 42 95 72 17 10
                0 0 1 37 82 65 16 11
                0 0 60 64 79 64 15 10
                0 0 56 64 94 74 16 10
                0 0 62 63 76 59 10 5
                0 0 46 44 47 32 5 2
                0 0 43 56 84 62 13 7
                0 0 39 62 98 69 16 9
                0 0 35 62 93 70 16 9
                0 0 31 61 94 71 17 10
                0 0 39 65 97 70 14 8
                0 0 38 57 73 54 10 5
                0 0 19 33 44 30 5 2
                0 0 20 48 80 57 13 7
                0 0 21 52 82 57 13 7
                0 0 21 52 76 56 12 8
                0 0 21 51 75 53 12 8
                0 0 24 49 72 51 10 6
                0 0 22 38 49 36 5 3
                0 0 11 21 30 18 3 1
                0 0 5 13 21 14 2 1
                0 0 17 43 71 46 10 6
                0 0 17 41 67 45 10 5
                0 0 19 43 59 42 9 5
                0 0 20 40 60 43 9 5
                0 0 20 31 40 30 6 3
                0 0 12 20 26 16 2 1
                0 0 13 31 50 35 7 4
                0 0 17 35 52 36 8 5
                0 0 11 29 47 34 8 5
                0 0 12 32 51 35 8 5
                0 0 16 33 53 37 8 4
                0 0 17 29 39 27 5 3
                0 0 7 11 18 11 2 1
                0 0 11 28 43 30 6 3
                0 0 13 32 49 35 8 4
                0 0 12 31 47 34 8 5
                0 0 12 29 45 33 8 5
                0 0 16 31 48 36 8 5
                0 0 14 24 33 24 5 3
                0 0 7 13 18 12 2 1
                0 0 12 28 42 29 7 4
                0 0 12 26 41 30 6 4
                0 0 11 28 41 31 7 4
                0 0 10 26 40 28 6 4
                0 0 13 27 43 31 7 4
                0 0 13 21 30 22 4 2
                0 0 8 14 20 13 2 1
                0 0 14 24 35 24 6 3
                0 0 13 26 39 28 7 4
                0 0 11 25 37 28 6 4
                0 0 12 25 37 27 6 4
                0 0 13 26 41 29 6 4
                0 0 10 18 30 21 4 2
                0 0 2 3 5 4 1 0
                0 0 9 19 28 19 3 2
                0 0 12 26 39 27 6 4
                0 0 10 24 35 26 5 4
                0 0 10 23 32 24 6 4
                0 0 11 23 33 24 5 3
                0 0 10 20 28 21 4 2
                0 0 6 12 17 10 2 1
                0 0 10 24 35 23 5 3
                0 0 11 26 39 28 7 4
                0 0 10 25 36 26 7 4
                0 0 10 25 34 25 6 4
                0 0 12 26 37 27 6 3
                0 0 9 21 28 20 3 2
                0 0 6 13 17 11 2 1
                0 0 10 28 36 26 5 4
                0 0 12 31 42 31 7 5
                0 0 11 26 41 31 7 5
                0 0 12 28 43 32 8 5
                0 0 13 29 46 35 7 4
                0 0 10 20 30 22 4 2
                0 0 7 16 23 16 3 1
                0 0 12 29 47 32 7 3
                0 0 12 32 51 36 8 4
                0 0 12 31 50 36 8 5
                0 0 11 29 45 33 7 4
                0 0 17 37 64 46 9 5
                0 0 12 26 42 27 5 3
                0 0 7 17 30 18 3 1
                0 0 14 34 61 39 8 4
                0 0 15 39 72 42 9 5
                0 0 18 44 81 45 9 5
                0 0 21 46 80 48 9 5
                0 0 24 47 83 48 9 5
                0 0 24 36 58 34 5 3
                0 0 17 26 41 22 3 2
                0 0 50 66 82 44 8 4
                0 0 33 56 78 45 8 5
                0 0 22 43 69 38 7 4
                0 0 20 41 68 36 7 5
                0 0 19 41 70 37 6 3
                0 0 14 28 48 27 4 2
                0 0 8 18 32 16 3 2
                0 0 19 43 75 39 7 4
                0 0 20 49 87 42 8 5
                0 0 19 47 83 43 8 5
                0 0 17 45 77 41 8 4
                0 0 19 45 78 39 7 4
                0 0 14 32 53 27 5 2
                0 0 4 12 21 10 1 0
                0 0 16 46 78 36 6 3
                0 0 17 51 80 39 7 4
                0 0 15 44 70 34 6 4
                0 0 16 49 77 38 7 4
                0 0 15 44 72 35 6 3
                0 0 13 33 51 24 4 2
                0 0 8 23 35 15 2 1
                0 0 17 48 74 37 6 3
                0 0 16 47 74 35 7 4
                0 0 15 46 71 35 6 3
                0 0 15 49 66 30 6 3
                0 0 17 45 71 34 6 3
                0 0 11 30 46 21 3 2
                0 0 8 21 34 14 2 1
                0 0 5 17 26 10 1 1
                0 0 19 45 74 35 6 3
                0 0 19 46 79 37 6 3
                0 0 19 45 79 38 6 3
                0 0 21 52 92 42 6 3
                0 0 16 38 61 29 4 2
                0 0 8 27 45 18 2 1
                0 0 9 44 96 42 7 3
                0 0 9 42 90 40 7 4
                0 0 11 42 82 38 7 3
                0 0 12 41 79 37 6 3
                0 0 15 40 71 34 6 3
                0 0 11 29 51 23 4 2
                0 0 6 19 32 14 2 1
                0 0 7 33 69 32 6 3
                0 0 6 31 66 32 5 3
                0 0 7 30 70 34 6 3
                0 0 7 33 81 44 7 3
                0 0 11 36 91 46 7 3
                0 0 10 27 54 29 5 2
                0 0 5 16 35 16 2 1
                0 0 7 32 76 39 8 4
                0 0 6 26 60 28 6 3
                0 0 6 26 63 31 7 4
                0 0 6 27 65 34 7 4
                0 0 11 29 67 33 7 3
                0 0 9 20 37 19 4 2
                0 0 4 12 26 13 3 1
                0 0 5 23 52 27 6 3
                0 0 6 24 53 27 7 3
                0 0 5 23 51 28 7 3
                0 0 6 24 49 24 7 4
                0 0 8 25 46 23 6 3
                0 0 8 17 29 13 3 2
                0 0 3 9 18 8 2 1
                0 0 7 19 38 17 4 3
                0 0 5 20 42 19 5 4
                0 0 4 19 36 17 5 3
                0 0 4 19 37 17 5 3
                0 0 7 19 38 19 5 3
                0 0 6 13 23 10 2 1
                0 0 3 8 15 6 1 1
                0 0 4 18 35 16 5 3
                0 0 4 16 33 15 4 3
                0 0 4 16 33 15 4 3
                0 0 4 17 35 17 5 3
                0 0 7 19 39 19 5 3
                0 0 5 12 25 12 3 2
                0 0 3 7 16 7 2 1
                0 0 4 18 45 21 6 4
                0 0 4 16 42 21 5 3
                0 0 3 17 59 28 6 3
                0 0 4 18 63 27 6 4
                0 0 5 19 67 28 5 3
                0 0 4 10 21 11 3 2
                0 0 2 6 13 6 2 1
                0 0 4 16 34 18 6 4
                0 0 4 14 30 15 5 4
                0 0 8 13 32 15 6 4
                0 0 39 12 29 15 5 4
                0 0 51 15 33 16 5 3
                0 0 76 10 20 9 3 2
                0 0 48 6 12 5 1 1
                0 0 106 13 30 14 4 3
                0 0 122 13 28 13 5 3
                0 0 129 13 28 14 5 4
                0 0 75 14 25 13 5 4
                0 0 130 14 29 14 4 2
                0 0 70 8 18 10 3 1
                0 0 39 6 12 6 2 1
                0 0 81 14 31 15 6 3
                0 0 37 15 32 16 6 4
                0 0 41 14 32 16 5 4
                0 0 43 15 33 16 7 4
                0 0 59 15 33 16 5 3
                0 0 58 10 21 11 2 2
                0 0 22 6 14 7 2 1
                0 0 39 15 35 17 5 3
                0 0 37 15 32 15 5 3
                0 0 35 13 26 14 4 2
                0 0 2 1 1 1 0 0
                0 0 34 11 23 13 3 2
                0 0 30 9 19 10 3 1
                0 0 15 6 14 6 1 1
                0 0 23 14 35 19 6 3
                0 0 40 14 35 19 6 3
                0 0 42 16 36 19 6 4
                0 0 43 16 36 19 7 4
                0 0 64 17 38 19 6 4
                0 0 49 13 27 14 4 2
                0 0 23 8 18 10 2 1
                0 0 45 18 42 20 6 3
                0 0 47 19 39 21 6 4
                0 0 60 18 41 20 5 3
                0 0 60 18 39 19 6 3
                0 0 69 19 39 18 5 3
                0 0 57 13 26 13 3 2
                0 0 28 9 18 8 2 1
                0 0 49 19 40 18 5 3
                0 0 42 21 41 18 5 3
                0 0 40 22 40 18 5 3
                0 0 43 24 43 20 5 3
                0 0 68 25 48 23 6 3
                0 0 65 19 36 19 4 2
                0 0 26 13 24 12 2 1
                0 0 45 33 64 33 7 3
                0 0 46 33 69 37 8 4
                0 0 43 35 74 39 8 4
                0 0 44 37 76 40 8 3
                0 0 22 18 38 22 4 1
                0 0 0 0 1 1 0 0
                0 0 20 16 34 17 2 1
                0 0 60 41 91 46 7 3
                0 0 69 37 70 38 8 4
                0 0 72 32 59 34 7 3
                0 0 66 29 53 30 7 3
                0 0 17 9 18 11 2 1
                0 0 1 0 1 1 0 0
                0 0 24 12 23 12 2 1
                0 0 46 28 54 27 5 3
                0 0 41 27 50 23 5 3
                0 0 36 23 42 22 4 3
                0 0 38 23 40 20 5 3
                0 0 42 19 35 16 3 1
                0 0 37 13 23 11 2 1
                0 0 15 8 14 7 1 1
                0 0 29 22 39 18 4 2
                0 0 27 20 33 16 3 2
                0 0 27 20 31 15 3 2
                0 0 27 21 31 15 4 2
                0 0 43 20 31 15 3 2
                0 0 29 12 18 9 2 1
                0 0 10 7 10 4 1 0
                0 0 19 16 21 10 2 1
                0 0 24 20 28 13 3 1
                0 0 22 17 26 12 3 1
                0 0 18 15 21 9 2 1
                0 0 29 17 23 11 2 1
                0 0 24 10 15 6 1 1
                0 0 9 7 10 4 1 0
                0 0 17 16 24 10 2 1
                0 0 18 14 21 10 3 2
                0 0 17 13 19 10 2 1
                0 0 16 11 18 9 2 2
                0 0 25 13 20 9 2 1
                0 0 2 2 3 1 0 0
                0 0 6 6 7 3 0 0
                0 0 15 11 18 8 2 1
        ]
    else
        error("no state set")
    end
    rng = MersenneTwister(279*sim)

    if p.scenario == :statuscuo
        v = abs.(v)
    elseif p.scenario == :fast
        v = abs.(v)
        v = Int.(round.(p.α.*v))
    elseif p.scenario == :half
        v = Int.(round.(abs.(v/2)))
    else
        v = [0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0]
    end

    rp = Int.(round.(mean(v[end-30:end,:],dims=1)))
    l2 = p.modeltime-(p.day_inital_vac+size(v,1)-2)
    if l2 > 0
        v2 = repeat(rp,l2)
        v2 = Int.(p.α3.*v2)
    
        for i = 1:l2
            aux = sum(v2[i,:])
            aux = Int(round(p.α2*aux))
            aux_v = sample(rng,1:size(v2,2),aux)
    
            for j in aux_v
                v2[i,j] = v2[i,j] + 1
            end
        end
        v = [v;v2]
    end

    

    return v
end

function vaccination_rate_2(sim::Int64)
    
    
    if p.prov == :newyorkcity
        v = [0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0
                0 0 0 0 5 2 1 0
                0 0 0 0 13 6 1 0
                0 0 0 1 23 11 2 0
                0 0 0 1 32 14 3 1
                0 0 0 1 34 15 3 0
                0 0 0 0 9 4 1 0
                0 0 0 0 7 2 0 0
                0 0 0 1 33 23 7 9
                0 0 0 1 36 25 6 7
                0 0 0 2 38 27 8 13
                0 0 0 1 25 17 4 3
                0 0 0 1 17 11 3 2
                0 0 0 1 8 6 2 2
                0 0 0 1 5 4 2 2
                0 0 0 0 6 9 5 7
                0 0 0 2 36 34 11 11
                0 0 0 2 35 29 10 13
                0 0 0 3 31 25 8 6
                0 0 0 1 20 14 3 2
                0 0 0 1 15 9 2 1
                0 0 0 2 14 9 3 2
                0 0 0 4 46 41 11 10
                0 0 0 4 41 37 11 10
                0 0 0 6 47 40 12 15
                0 0 0 6 49 40 10 11
                0 0 0 7 46 32 10 10
                0 0 0 3 17 12 4 4
                0 0 0 2 12 9 5 3
                0 0 0 2 20 20 8 10
                0 0 0 4 34 33 11 19
                0 0 0 8 64 66 35 39
                0 0 0 8 59 60 32 38
                0 0 0 9 64 57 31 36
                0 0 0 5 36 30 20 16
                0 0 0 4 30 21 9 11
                0 0 0 7 68 63 36 47
                0 0 0 7 75 70 47 61
                0 0 0 7 70 66 60 72
                0 0 0 7 70 71 78 81
                0 0 0 8 68 60 74 72
                0 0 0 6 47 44 75 57
                0 0 0 6 52 47 62 57
                0 0 0 2 18 25 31 26
                0 0 0 5 48 55 79 61
                0 0 0 4 38 45 68 54
                0 0 0 6 51 55 77 58
                0 0 0 6 50 50 72 55
                0 0 0 6 48 50 83 65
                0 0 0 5 33 34 52 41
                0 0 0 3 24 28 37 30
                0 0 0 3 26 35 48 35
                0 0 0 4 35 43 76 50
                0 0 0 7 54 62 110 74
                0 0 0 8 63 71 111 72
                0 0 0 7 49 55 75 53
                0 0 0 4 30 38 50 26
                0 0 0 4 29 37 47 27
                0 0 0 3 26 32 50 27
                0 0 0 5 34 43 56 34
                0 0 0 8 56 68 82 46
                0 0 0 10 67 77 87 51
                0 0 0 7 57 71 71 41
                0 0 0 8 57 63 54 27
                0 0 0 8 58 71 55 32
                0 0 0 8 52 68 53 30
                0 0 0 8 47 68 58 36
                0 0 0 10 70 90 75 46
                0 0 0 11 72 90 119 70
                0 0 0 10 68 86 98 58
                0 0 0 8 50 60 57 32
                0 0 0 8 59 84 52 31
                0 0 0 8 66 101 59 39
                0 0 0 11 79 115 67 44
                0 0 0 12 92 132 71 44
                0 0 0 15 100 149 74 48
                0 0 0 15 92 134 57 35
                0 0 0 11 66 89 36 22
                0 0 0 14 91 133 60 36
                0 0 0 16 104 158 79 48
                0 0 0 18 111 165 101 63
                0 0 0 25 159 226 114 71
                0 0 0 27 168 234 128 78
                0 0 0 24 146 203 98 56
                0 0 0 20 118 154 61 36
                0 0 0 18 120 172 94 56
                0 0 0 17 120 176 117 69
                0 0 0 22 159 214 106 65
                0 0 0 28 209 284 118 73
                0 0 0 31 209 286 115 67
                0 0 0 26 170 227 75 44
                0 0 0 20 120 144 39 20
                0 0 0 24 169 208 75 45
                0 0 0 30 178 216 86 53
                0 0 0 39 194 239 92 56
                0 0 0 49 229 289 87 54
                0 0 0 56 249 295 78 48
                0 0 0 43 193 218 53 30
                0 0 0 35 150 165 31 16
                0 0 0 39 179 208 51 33
                0 0 0 22 115 166 49 29
                0 0 0 24 127 200 57 31
                0 0 0 28 154 214 55 32
                0 0 0 28 149 209 50 29
                0 0 0 26 130 180 39 22
                0 0 0 24 120 147 27 13
                0 0 0 26 151 178 35 19
                0 0 0 27 166 189 43 24
                0 0 0 29 214 207 39 22
                0 0 0 31 229 229 38 21
                0 0 0 29 213 206 34 19
                0 0 0 29 208 192 32 16
                0 0 0 26 168 137 21 10
                0 0 0 30 215 191 28 19
                0 0 0 51 248 209 37 23
                0 0 0 77 304 235 42 28
                0 0 0 75 321 215 44 27
                0 0 0 74 301 192 39 22
                0 0 0 73 259 159 27 14
                0 0 0 70 218 118 20 9
                0 0 0 94 310 185 29 17
                0 0 0 111 332 193 33 20
                0 0 0 102 272 169 32 19
                0 0 0 106 273 171 36 21
                0 0 0 116 286 181 35 19
                0 0 0 103 214 145 27 14
                0 0 0 79 156 94 16 8
                0 0 0 90 206 139 27 14
                0 0 0 98 224 158 31 18
                0 0 0 92 211 158 29 16
                0 0 0 87 210 155 31 17
                0 0 0 91 221 170 32 18
                0 0 0 79 183 145 24 12
                0 0 0 50 109 77 11 5
                0 0 0 62 158 120 24 14
                0 0 0 66 169 132 27 16
                0 0 0 60 152 121 27 18
                0 0 0 61 157 124 26 19
                0 0 0 66 165 132 28 18
                0 0 0 53 132 104 17 9
                0 0 0 33 77 56 8 4
                0 0 0 47 124 100 20 12
                0 0 0 49 123 96 21 14
                0 0 0 44 110 92 21 13
                0 0 0 41 111 92 22 12
                0 0 0 46 119 102 20 12
                0 0 0 39 96 74 12 6
                0 0 0 23 53 34 6 3
                0 0 0 17 39 29 6 3
                0 0 1 53 129 102 24 13
                0 0 2 43 105 83 19 12
                0 0 44 58 97 76 18 11
                0 0 51 61 107 82 17 12
                0 0 54 60 86 63 11 6
                0 0 44 43 51 34 5 3
                0 0 44 55 92 69 15 9
                0 0 41 62 104 75 18 10
                0 0 34 59 100 76 18 11
                0 0 30 59 100 74 17 11
                0 0 38 67 112 80 18 11
                0 0 34 56 84 61 11 5
                0 0 19 33 50 34 5 3
                0 0 22 51 91 65 14 8
                0 0 23 58 100 68 15 9
                0 0 22 55 88 64 14 9
                0 0 21 52 87 62 14 8
                0 0 24 51 87 61 13 8
                0 0 22 40 61 45 7 3
                0 0 10 22 37 22 3 1
                0 0 8 26 53 39 8 4
                0 0 16 43 76 52 11 6
                0 0 17 42 72 52 12 8
                0 0 18 42 68 49 11 7
                0 0 19 40 68 49 10 6
                0 0 19 31 46 34 6 3
                0 0 11 20 28 17 3 1
                0 0 13 31 49 35 7 4
                0 0 16 36 58 40 8 5
                0 0 10 29 54 38 8 5
                0 0 11 31 52 36 9 6
                0 0 15 31 54 39 9 5
                0 0 13 26 40 27 5 2
                0 0 2 4 10 5 1 0
                0 0 9 22 37 25 5 2
                0 0 14 36 59 44 10 6
                0 0 11 32 53 38 9 6
                0 0 11 28 48 35 8 6
                0 0 14 30 52 36 8 5
                0 0 15 26 40 27 6 3
                0 0 7 15 23 14 2 1
                0 0 12 28 46 33 7 4
                0 0 11 27 44 32 7 4
                0 0 10 28 43 32 7 5
                0 0 9 25 43 32 7 5
                0 0 12 26 46 32 8 5
                0 0 12 21 34 24 4 2
                0 0 7 14 22 13 2 1
                0 0 13 25 39 26 6 4
                0 0 11 25 41 29 7 4
                0 0 9 25 41 30 7 4
                0 0 11 25 39 29 7 4
                0 0 11 25 42 31 6 4
                0 0 10 20 32 22 4 2
                0 0 3 7 13 7 1 1
                0 0 9 21 33 23 5 3
                0 0 11 25 40 27 7 4
                0 0 9 23 38 27 6 4
                0 0 9 22 34 25 6 4
                0 0 10 24 39 29 6 4
                0 0 9 20 30 21 4 2
                0 0 6 11 17 10 2 1
                0 0 9 22 34 24 5 3
                0 0 10 25 42 29 6 4
                0 0 9 25 41 28 7 4
                0 0 9 24 39 28 7 4
                0 0 11 25 40 29 6 3
                0 0 8 19 29 20 4 2
                0 0 5 13 18 11 2 1
                0 0 10 28 40 27 6 4
                0 0 11 29 42 29 7 5
                0 0 9 24 39 28 7 4
                0 0 11 26 40 31 7 4
                0 0 11 26 43 31 6 4
                0 0 9 19 30 21 4 2
                0 0 6 15 23 15 2 1
                0 0 11 28 46 31 6 4
                0 0 11 31 50 36 8 5
                0 0 11 30 49 36 8 5
                0 0 10 27 45 34 7 4
                0 0 14 30 56 40 8 5
                0 0 10 23 39 27 5 3
                0 0 5 12 19 12 2 1
                0 0 13 33 59 38 8 4
                0 0 14 35 60 40 9 5
                0 0 15 34 60 38 8 4
                0 0 18 39 66 43 8 5
                0 0 21 40 69 45 8 4
                0 0 22 32 54 33 5 3
                0 0 15 22 35 20 3 1
                0 0 39 51 72 43 8 4
                0 0 31 47 68 43 8 4
                0 0 23 39 69 37 7 4
                0 0 19 35 61 34 6 4
                0 0 20 40 71 42 8 4
                0 0 14 27 47 27 4 2
                0 0 7 15 30 16 2 1
                0 0 6 13 25 12 2 1
                0 0 25 48 85 49 9 5
                0 0 20 40 73 42 7 4
                0 0 20 41 74 41 8 4
                0 0 21 43 78 42 8 4
                0 0 16 31 53 29 5 2
                0 0 6 16 30 15 2 1
                0 0 11 36 73 37 6 3
                0 0 12 39 74 38 7 4
                0 0 12 36 69 35 6 3
                0 0 14 41 74 39 7 3
                0 0 15 41 72 38 6 3
                0 0 14 32 52 27 4 2
                0 0 7 20 33 16 2 1
                0 0 12 39 69 36 6 3
                0 0 12 39 69 35 6 3
                0 0 12 38 64 34 5 3
                0 0 12 45 68 36 6 3
                0 0 16 42 72 39 6 3
                0 0 14 29 47 25 4 2
                0 0 7 19 33 16 2 1
                0 0 7 25 48 24 4 2
                0 0 13 34 62 32 5 3
                0 0 14 34 68 35 6 3
                0 0 14 35 69 36 6 3
                0 0 18 39 72 38 6 3
                0 0 17 30 49 27 4 2
                0 0 7 19 35 16 2 1
                0 0 8 27 66 34 5 2
                0 0 7 31 68 35 7 3
                0 0 7 29 64 34 6 3
                0 0 10 31 68 35 7 3
                0 0 14 33 63 36 6 3
                0 0 11 23 44 23 4 1
                0 0 5 15 29 13 2 1
                0 0 7 25 54 28 5 2
                0 0 6 27 64 34 6 3
                0 0 6 25 59 32 5 3
                0 0 6 25 64 35 7 3
                0 0 10 28 67 37 6 3
                0 0 9 20 41 22 3 1
                0 0 4 13 26 12 2 1
                0 0 6 24 63 34 6 2
                0 0 5 21 52 28 5 2
                0 0 5 20 56 29 5 3
                0 0 5 20 54 31 6 3
                0 0 9 24 61 31 6 3
                0 0 8 17 36 20 3 1
                0 0 4 10 25 14 2 1
                0 0 4 20 54 30 6 2
                0 0 4 19 50 26 5 2
                0 0 5 18 55 29 6 3
                0 0 5 19 51 28 6 3
                0 0 7 20 53 30 5 3
                0 0 6 13 30 17 3 2
                0 0 2 7 18 9 1 1
                0 0 5 16 44 23 5 2
                0 0 5 17 40 21 5 3
                0 0 4 16 40 23 5 3
                0 0 3 15 38 20 5 3
                0 0 6 17 40 22 5 2
                0 0 5 11 23 13 2 1
                0 0 2 6 15 7 1 1
                0 0 3 14 36 18 4 2
                0 0 3 13 33 16 4 2
                0 0 4 13 31 17 4 3
                0 0 4 13 30 16 4 3
                0 0 6 14 33 17 3 2
                0 0 5 9 21 11 2 1
                0 0 2 6 13 7 1 1
                0 0 4 13 36 19 4 2
                0 0 3 13 34 18 4 3
                0 0 3 13 40 20 4 2
                0 0 3 13 39 20 4 3
                0 0 4 13 39 20 4 2
                0 0 4 8 20 10 2 1
                0 0 2 4 12 5 1 1
                0 0 3 12 35 19 4 2
                0 0 4 11 28 14 3 2
                0 0 6 10 27 14 3 2
                0 0 1 1 2 1 0 0
                0 0 33 9 26 13 2 1
                0 0 46 7 16 8 2 1
                0 0 45 4 10 5 1 0
                0 0 61 12 34 17 4 2
                0 0 76 11 29 15 3 2
                0 0 73 11 29 16 4 2
                0 0 75 11 26 14 4 2
                0 0 95 12 27 15 4 2
                0 0 92 8 18 10 2 1
                0 0 45 5 10 5 1 1
                0 0 64 11 26 13 4 2
                0 0 55 11 26 14 4 2
                0 0 51 11 26 13 3 2
                0 0 53 11 25 13 3 2
                0 0 70 11 23 13 3 2
                0 0 65 7 14 9 1 1
                0 0 27 4 10 4 1 0
                0 0 40 10 26 12 3 2
                0 0 31 11 26 13 3 2
                0 0 29 10 23 12 3 2
                0 0 14 8 19 10 2 1
                0 0 37 10 21 12 3 1
                0 0 38 7 14 7 1 1
                0 0 16 5 10 5 1 0
                0 0 20 11 24 14 3 1
                0 0 26 12 26 13 3 2
                0 0 27 14 25 14 3 2
                0 0 31 13 23 13 3 1
                0 0 16 5 11 6 1 1
                0 0 0 0 0 0 0 0
                0 0 27 6 10 5 1 0
                0 0 52 15 30 16 4 1
                0 0 42 15 27 15 3 2
                0 0 42 13 25 13 3 1
                0 0 42 12 23 12 3 1
                0 0 18 4 7 4 1 0
                0 0 1 0 0 0 0 0
                0 0 38 6 10 4 1 0
                0 0 47 14 28 12 3 1
                0 0 41 15 26 13 3 1
                0 0 35 13 23 11 2 1
                0 0 37 13 24 12 2 2
                0 0 53 12 23 10 2 1
                0 0 64 10 17 9 1 1
                0 0 26 5 9 5 1 0
                0 0 36 16 31 16 3 1
                0 0 34 16 31 15 3 2
                0 0 34 16 31 16 3 2
                0 0 35 17 33 17 3 2
                0 0 40 14 27 14 2 1
                0 0 26 6 12 6 1 0
                0 0 18 6 11 5 1 0
                0 0 31 13 25 13 2 1
                0 0 45 19 37 18 3 1
                0 0 45 15 31 15 3 1
                0 0 42 14 28 15 2 1
                0 0 41 12 23 12 2 1
                0 0 34 6 11 6 1 0
                0 0 19 6 11 5 1 0
                0 0 34 16 32 15 2 1
                0 0 33 14 28 14 3 2
                0 0 31 13 25 13 2 1
                0 0 31 13 25 13 2 1
                0 0 45 12 23 12 2 1
                0 0 3 1 2 1 0 0
                0 0 18 5 9 4 0 0
                0 0 29 12 24 11 2 1        
        ]
    else
        error("no state set")
    end

    rng = MersenneTwister(279*sim)
    if p.scenario == :statuscuo
        v = abs.(v)
    elseif p.scenario == :fast
        v = abs.(v)
        v = Int.(round.(p.α.*v))
    elseif p.scenario == :half
        v = Int.(round.(abs.(v/2)))
    else
        v = [0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0]
    end

    
    rp = Int.(round.(mean(v[end-30:end,:],dims=1)))
    l2 = p.modeltime-(p.day_inital_vac+size(v,1)-2)
    if l2 > 0
        v2 = repeat(rp,l2)
        v2 = Int.(p.α3.*v2)
    
        for i = 1:l2
            aux = sum(v2[i,:])
            aux = Int(round(p.α2*aux))
            aux_v = sample(rng,1:size(v2,2),aux)
    
            for j in aux_v
                v2[i,j] = v2[i,j] + 1
            end
        end
        v = [v;v2]
    end

    

    return v
end





function temporal_proportion()
    
    if p.prov == :newyorkcity
        v = [92; 123; 154; 182; 213; 243; 274; 304; 335; 366; 396; 427; 457; 488]
        fd = [0.810164466064397 0.189631688672689 0.000203845262914061
                0.423107357835277 0.576847516901828 4.51252628949468e-05
                0.508979796036175 0.490752357129113 0.000267846834712334
                0.538627221359379 0.373256203472228 0.0881165751683928
                0.575766618332785 0.313200654173252 0.111032727493963
                0.598912208679336 0.284878382293652 0.116209409027012
                0.643791380421072 0.208846951315241 0.147361668263687
                0.70996913019793 0.186044208197831 0.103986661604239
                0.760551879008523 0.176515370612953 0.0629327503785237
                0.768437962703105 0.160302130006871 0.0712599072900235
                0.717294705873386 0.172767945610585 0.109937348516029
                0.657303226138675 0.240721954736219 0.101974819125106
                0.657088086185044 0.285133079847909 0.0577788339670469
                0.649547563423382 0.291823237142575 0.058629199434043
        ]
        sd = [
                0.82016348773842 0.17983651226158 0
                0.84751598023265 0.15248401976735 0
                0.422153838801731 0.577846161198269 0
                0.592876361707527 0.407123638292473 0
                0.57612054735136 0.42387945264864 0
                0.612093208532092 0.387906791467908 0
                0.68263941155019 0.31736058844981 0
                0.736047570072466 0.263952429927534 0
                0.818337668274809 0.181662331725191 0
                0.803241318829385 0.196758681170615 0
                0.816980258143106 0.183019741856894 0
                0.773018071037873 0.226981928962127 0
                0.763567782288273 0.236432217711727 0
                0.719199252790001 0.280800747209999 0
        ]
   
    else
        
        error("no distribution for proportion")
    end

    if !p.using_jj
        sd[:,3] .= 0
        fd[:,3] .= 0
        
    end

    return v,fd,sd
end


function get_breaks_vac()

    if p.prov == :newyorkcity
        brak = @SVector [0:0,1:4,5:14,15:24,25:44,45:64,65:74,75:100]
    end
    return brak
end


function waning_factor()
    M = [1	1	1	1
            0.9985	0.9972	1	1
            0.9951	0.9934	1	1
            0.9897	0.9885	1	1
            0.9824	0.9825	1	1
            0.9733	0.9756	0.9989	1
            0.9623	0.9676	0.9967	1
            0.9496	0.9587	0.9935	1
            0.9352	0.9488	0.9891	1
            0.9192	0.9381	0.9837	1
            0.9016	0.9264	0.9772	1
            0.8827	0.9139	0.9697	0.9987
            0.8625	0.9006	0.9612	0.9961
            0.8411	0.8866	0.9517	0.9923
            0.8186	0.8718	0.9413	0.9872
            0.7951	0.8563	0.9299	0.9809
            0.7708	0.8402	0.9177	0.9733
            0.7457	0.8235	0.9046	0.9646
            0.7201	0.8063	0.8907	0.9547
            0.6939	0.7886	0.8761	0.9436
            0.6674	0.7705	0.8608	0.9315
            0.6406	0.7519	0.8448	0.9183
            0.6137	0.733	0.8282	0.9041
            0.5868	0.7138	0.811	0.889
            0.5599	0.6944	0.7933	0.873
            0.5332	0.6747	0.7751	0.8562
            0.5068	0.655	0.7565	0.8386
            0.4808	0.6351	0.7375	0.8203
            0.4551	0.6151	0.7182	0.8014
            0.43	0.5951	0.6987	0.7819
            0.4055	0.5752	0.6789	0.7618
            0.3816	0.5553	0.659	0.7414
            0.3585	0.5356	0.6389	0.7205
            0.336	0.5159	0.6188	0.6994
            0.3144	0.4965	0.5986	0.678
            0.2936	0.4773	0.5785	0.6564
            0.2736	0.4583	0.5584	0.6347
            0.2544	0.4396	0.5384	0.6129
            0.2362	0.4213	0.5185	0.5911
            0.2188	0.4032	0.4989	0.5694
            0.2023	0.3855	0.4794	0.5478
            0.1867	0.3682	0.4602	0.5263
            0.1719	0.3513	0.4413	0.5051
            0.158	0.3348	0.4227	0.4841
            0.1449	0.3187	0.4044	0.4634
            0.1327	0.3031	0.3865	0.443
            0.1212	0.2879	0.369	0.423
            0.1105	0.2732	0.3519	0.4034
            0.1006	0.259	0.3352	0.3842
            0.0914	0.2452	0.3189	0.3655
            0.0828	0.2319	0.3031	0.3473
            0.0749	0.2192	0.2878	0.3296
            0.0677	0.2068	0.2729	0.3124
            0.061	0.195	0.2586	0.2958
            0.0548	0.1837	0.2447	0.2797
            0.0492	0.1728	0.2313	0.2642
            0.0441	0.1624	0.2184	0.2492
            0.0394	0.1524	0.2059	0.2348
            0.0352	0.1429	0.194	0.2209
            0.0313	0.1339	0.1826	0.2077
            0.0278	0.1253	0.1716	0.195
            0.0247	0.1171	0.1612	0.1828
            0.0219	0.1093	0.1512	0.1712
            0.0193	0.102	0.1416	0.1602
            0.017	0.095	0.1325	0.1497
            0.015	0.0884	0.1239	0.1397
            0.0132	0.0822	0.1157	0.1303
            0.0115	0.0763	0.1079	0.1213
            0.0101	0.0708	0.1005	0.1128
            0.0088	0.0656	0.0936	0.1048
            0.0077	0.0607	0.087	0.0973
            0.0067	0.0562	0.0808	0.0901
            0.0058	0.0519	0.0749	0.0835
            0.005	0.0479	0.0694	0.0772
            0.0043	0.0441	0.0643	0.0713
            0.0037	0.0406	0.0594	0.0658
            0.0032	0.0374	0.0549	0.0606
            0.0028	0.0343	0.0506	0.0558
            0.0024	0.0315	0.0467	0.0513
            0.002	0.0289	0.0429	0.0471
            0.0017	0.0264	0.0395	0.0432
            0.0015	0.0242	0.0363	0.0396
            0.0013	0.0221	0.0333	0.0363
            0.0011	0.0202	0.0305	0.0332
            0.0009	0.0184	0.0279	0.0303
            0.0008	0.0168	0.0255	0.0276
            0.0006	0.0152	0.0233	0.0252
            0.0005	0.0139	0.0213	0.0229
            0.0005	0.0126	0.0194	0.0209
            0.0004	0.0114	0.0176	0.0189
            0.0003	0.0103	0.016	0.0172
            0.0003	0.0093	0.0146	0.0156
            0.0002	0.0085	0.0132	0.0141
            0.0002	0.0076	0.012	0.0127
            0.0002	0.0069	0.0109	0.0115
            0.0001	0.0062	0.0098	0.0104
            0.0001	0.0056	0.0089	0.0094
            0.0001	0.005	0.008	0.0084
            0.0001	0.0045	0.0072	0.0076
            0.0001	0.004	0.0065	0.0068
    ]

    return M
end




function vector_probs()
    if p.prov == :newyorkcity
        v = [
            0.00139537040550054
            0.00226800386150843
            0.0029129938072534
            0.00416924873425993
            0.00541707242014561
            0.0068377365490087
            0.00811085395825692
            0.00945563691703237
            0.0101722924123046
            0.0108341448402912
            0.0120103029766497
            0.013055776875635
            0.0143036005615207
            0.0156062273146919
            0.0171154194753239
            0.0177857031444314
            0.0184854961574619
            0.0197417510844684
            0.0210485934582
            0.022477688828184
            0.0237002187907071
            0.0251461766429327
            0.0257785197269964
            0.026558409530675
            0.0277387832875939
            0.0290287631790838
            0.0303735461378592
            0.0312419639733067
            0.0328143904423451
            0.0334256554236066
            0.034272995156252
            0.035474447015973
            0.036675898875694
            0.0379827412494256
            0.0393738960343657
            0.0407650508193059
            0.0414269032472925
            0.0421351275014439
            0.0434588323574172
            0.0448162621778739
            0.0462875137534621
            0.0477840590524128
            0.0495967758933954
            0.0504483312466012
            0.0514432176988614
            0.0532643657809648
            0.0550897294836286
            0.0570373461825448
            0.0587952599562419
            0.0609199327186959
            0.0619148191709561
            0.0630783304456333
            0.0644526227483317
            0.0661768115575453
            0.0680864876714177
            0.0701310636432236
            0.0720491709982168
            0.0727447483906869
            0.0732969946841025
            0.0743424685830878
            0.0761467541829495
            0.0779004523360861
            0.0798227753116398
            0.0817450982871934
            0.0826598879488055
            0.0835788932309781
            0.0849869104981599
            0.0862853216307707
            0.0879504917521384
            0.0896114462529457
            0.0913693600266427
            0.0921450342097608
            0.0930682551124938
            0.0946870534076969
            0.0963142829440208
            0.0978698469308174
            0.0997078574951626
            0.101385674478212
            0.102203504866934
            0.103084569564063
            0.104884639543364
            0.106490790976886
            0.108101158030968
            0.10990544363083
            0.111882569673669
            0.112767849991358
            0.113838617613706
            0.115592315766842
            0.117826594663867
            0.120014501734728
            0.122455346039214
            0.12539784919039
            0.126401166883771
            0.12788084970048
            0.130629434305877
            0.133373803290713
            0.13651444060823
            0.140970351540599
            0.142951693203998
            0.144937250487958
            0.146868004704633
            0.151281759431397
            0.155817767154414
            0.160379068600793
            0.164649492228504
            0.168456197594567
            0.170020192822484
            0.172140649964378
            0.175867258539793
            0.180609831670271
            0.1862629788418
            0.191734854329232
            0.196987517547521
            0.19896464359036
            0.201772246883603
            0.20641786074119
            0.211716895785644
            0.21772837070481
            0.224169838921138
            0.230847381888851
            0.234283112645597
            0.23888235467702
            0.246997424255838
            0.255639446404708
            0.265651545235716
            0.277274011120807
            0.287117485129398
            0.291560749200086
            0.298503876263105
            0.309434980376286
            0.321744592412726
            0.336625732991025
            0.349930231479725
            0.366316348598095
            0.376572953421608
            0.38622250888442
            0.401735992546783
            0.41719467314186
            0.43397705859291
            0.45204520831489
            0.466783017794134
            0.479691247950154
            0.496157461859173
            0.515954016010927
            0.538157689502683
            0.562515545100817
            0.588913761050195
            0.616639897476108
            0.633300029930906
            0.650385940062307
            0.674988301652945
            0.699927912888417
            0.723328822619334
            0.746708654247448
            0.772912951651048
            0.788181929320906
            0.803063069899205
            0.824824103232116
            0.846260533781875
            0.866891780804593
            0.885904229532108
            0.901017229241231
            0.911910392769368
            0.923060709151691
            0.939961131978433
            0.955601084257608
            0.968146771045432
            0.978496119521274
            0.987441666350495
            0.991804833630535
            0.994515477650888
            0.99712494677779
            0.998621492076741
            0.999274913263607
            0.999565791082276
            0.99980608145422
            0.999894609485989
            0.999924118829912
            0.999957843794396
            0.999970490656077
            0.999991568758879
            0.99999578437944
            0.99999578437944
            0.99999578437944
            1  
        ]
    end

    return v
end

function booster_doses()

    if p.prov == :newyorkcity
        v = [0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                1
                0
                1
                0
                0
                0
                0
                1
                1
                1
                1
                0
                0
                0
                1
                1
                1
                1
                1
                0
                1
                2
                1
                2
                2
                2
                1
                1
                2
                3
                3
                3
                3
                3
                3
                2
                3
                3
                3
                3
                3
                3
                2
                2
                3
                4
                4
                4
                4
                4
                2
                3
                3
                4
                3
                2
                4
                3
                3
                3
                4
                3
                3
                4
                3
                5
                5
                4
                4
                3
                4
                3
                4
                5
                6
                5
                4
                5
                5
                5
                9
                6
                4
                3
                5
                6
                5
                6
                7
                5
                4
                6
                5
                6
                7
                5
                5
                3
                5
                4
                7
                5
                5
                4
                3
                4
                5
                6
                5
                4
                5
                2
                4
                4
                4
                4
                4
                3
                2
                3
                4
                4
                4
                4
                3
                2
                2
                3
                3
                4
                4
                2
                1
                3
                3
                3
                3
                2
                2
                1
                1
                3
                2
                2
                2
                2
                1
                2
                2
                2
                2
                2
                1
                1
                2
                2
                2
                2
                2
                1
                1
                1
                1
                1
                2
                1
                1
                1
                2
                2
                2
                2
                1
                1
                0
                1
                2
                2
                1
                1
                1
                0
                1
                2
                2
                1
                1
                1
                0
                1
                1
                2
                2
                2
                1
                1
                1
                2
                2
                2
                2
                2
                1
                2
                2
                2
                2
                2
                1
                1
                2
                2
                2
                2
                3
                6
                8
                16
                22
                24
                24
                23
                13
                6
                18
                21
                19
                21
                20
                13
                10
                22
                23
                22
                21
                22
                12
                9
                3
                18
                21
                22
                23
                12
                8
                19
                18
                18
                17
                21
                13
                9
                22
                23
                20
                26
                52
                41
                28
                99
                106
                103
                107
                112
                49
                30
                104
                107
                108
                111
                117
                48
                28
                98
                116
                97
                111
                120
                46
                28
                104
                98
                108
                119
                183
                109
                71
                221
                198
                238
                240
                256
                133
                78
                236
                237
                237
                255
                268
                149
                82
                222
                234
                256
                250
                263
                156
                91
                285
                345
                347
                363
                399
                252
                148
                399
                377
                294
                12
                300
                212
                135
                392
                424
                453
                470
                528
                346
                188
                477
                473
                450
                455
                481
                301
                171
                423
                423
                414
                445
                507
                345
                202
                520
                534
                547
                509
                233
                5
                199
                498
                540
                514
                508
                174
                6
                128
                308
                309
                290
                306
                277
                216
                115
                282
                240
                253
                255
                302
                183
                93
                174
                219
                196
                168
                213
                135
                73
                173
                163
                154
                157
                185
                29
                53
                126
        ]
    end

    rp = Int.(round.(mean(v[end-30:end])))
    l2 = p.modeltime-(p.day_inital_vac+length(v)-2)
    if l2 > 0
        v2 = repeat([rp],l2)
        v = [v;v2]
    end
    return v
end